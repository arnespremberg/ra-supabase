var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,s=(e,t)=>{for(var r in t||(t={}))n.call(t,r)&&l(e,r,t[r]);if(a)for(var r of a(t))o.call(t,r)&&l(e,r,t[r]);return e},i=(e,a)=>t(e,r(a)),c=(e,t)=>{var r={};for(var l in e)n.call(e,l)&&t.indexOf(l)<0&&(r[l]=e[l]);if(null!=e&&a)for(var l of a(e))t.indexOf(l)<0&&o.call(e,l)&&(r[l]=e[l]);return r};import{u as m,a as d,r as p,b as u,c as x,d as f,e as E,R as g,T as b,f as h,C as y,A as v,g as w,P as _,h as S,N as k,m as C,i as N,j as P,k as I,F as O,l as D,B as T,n as F,o as L,p as A,q as j,s as W,t as z,v as B,w as $,x as R,y as M,z as V,L as U,D as K,U as q,E as H,G,H as J,I as X,J as Y,K as Z,M as Q,O as ee,Q as te,S as re,V as ae,W as ne,X as oe,Y as le,Z as se,_ as ie,$ as ce,a0 as me,a1 as de,a2 as pe,a3 as ue,a4 as xe,a5 as fe,a6 as Ee,a7 as ge,a8 as be,a9 as he,aa as ye,ab as ve,ac as we,ad as _e,ae as Se,af as ke,ag as Ce,ah as Ne,ai as Pe,aj as Ie,ak as Oe,al as De,am as Te,an as Fe,ao as Le,ap as Ae,aq as je,ar as We,as as ze,at as Be,au as $e,av as Re,aw as Me,ax as Ve,ay as Ue,az as Ke,aA as qe,aB as He,aC as Ge,aD as Je,aE as Xe,aF as Ye,aG as Ze,aH as Qe,aI as et,aJ as tt,aK as rt,aL as at,aM as nt,aN as ot,aO as lt,aP as st,aQ as it,aR as ct,aS as mt,aT as dt,aU as pt,aV as ut,aW as xt,aX as ft,aY as Et,aZ as gt,a_ as bt,a$ as ht,b0 as yt,b1 as vt,b2 as wt,b3 as _t,b4 as St,b5 as kt,b6 as Ct,b7 as Nt,b8 as Pt,b9 as It,ba as Ot,bb as Dt,bc as Tt,bd as Ft,be as Lt,bf as At,bg as jt,bh as Wt,bi as zt,bj as Bt,bk as $t,bl as Rt,bm as Mt,bn as Vt,bo as Ut,bp as Kt,bq as qt,br as Ht,bs as Gt,bt as Jt,bu as Xt,bv as Yt,bw as Zt,bx as Qt,by as er,bz as tr,bA as rr,bB as ar,bC as nr,bD as or,bE as lr}from"./vendor.d1f31a74.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var sr,ir=(sr=function(e,t){return(sr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),cr=function(e,t,r,a){return new(r||(r=Promise))((function(n,o){function l(e){try{i(a.next(e))}catch(t){o(t)}}function s(e){try{i(a.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,s)}i((a=a.apply(e,t||[])).next())}))},mr=function(e,t){var r,a,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=l.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(s){o=[6,s],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},dr=function(e){function t(t,r){var a=e.call(this,t)||this;return a.redirectTo=r,a}return ir(t,e),t}(Error),pr=function(){return(pr=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},ur=function(e,t,r,a){return new(r||(r=Promise))((function(n,o){function l(e){try{i(a.next(e))}catch(t){o(t)}}function s(e){try{i(a.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,s)}i((a=a.apply(e,t||[])).next())}))},xr=function(e,t){var r,a,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=l.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(s){o=[6,s],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},fr=function(e){var t=e.client;e.resource;var r=e.resourceOptions,a=e.params;return ur(void 0,void 0,void 0,(function(){var e,n,o,l,s,i,c,m,d,p,u,x,f;return xr(this,(function(E){switch(E.label){case 0:return e=a.pagination,n=a.sort,o=a.filter,l=o.q,s=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(o,["q"]),i=(e.page-1)*e.perPage,c=i+e.perPage,m=t.from(r.table).select(r.fields.join(", "),{count:"exact"}).order(n.field,{ascending:"ASC"===n.order}).match(s).range(i,c),l&&(Array.isArray(r)?r:r.fullTextSearchFields).forEach((function(e){m=m.ilike(e,"%"+l+"%")})),[4,m];case 1:if(d=E.sent(),p=d.data,u=d.error,x=d.count,u)throw u;return[2,{data:"id"===r.primaryKey?p:null!==(f=p.map((function(e){return pr(pr({},e),{id:e[r.primaryKey]})})))&&void 0!==f?f:[],total:null!=x?x:0}]}}))}))},Er=function(e,t){var r,a,n,o=t[e];return Array.isArray(o)?{table:e,primaryKey:"id",fields:o,fullTextSearchFields:o}:{table:null!==(r=o.table)&&void 0!==r?r:e,primaryKey:null!==(a=o.primaryKey)&&void 0!==a?a:"id",fields:o.fields,fullTextSearchFields:null!==(n=o.fullTextSearchFields)&&void 0!==n?n:o.fields}},gr=function(){return(gr=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},br=function(e){var t=e.theme;e.title,e.classes;var r=e.className,a=e.children,n=e.notification;e.staticContext;var o=e.backgroundImage,l=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(e,["theme","title","classes","className","children","notification","staticContext","backgroundImage"]),s=p.exports.useRef(null),i=hr(e),c=p.exports.useMemo((function(){return E(t)}),[t]),m=!1,d=function(){!m&&s.current&&(s.current.style.backgroundImage="url("+o+")",m=!0)};return p.exports.useEffect((function(){m||function(){if(o){var e=new Image;e.onload=d,e.src=o}}()})),g.createElement(b,{theme:c},g.createElement("div",gr({className:h(i.main,r)},l,{ref:s}),g.createElement(y,{className:i.card},g.createElement("div",{className:i.avatar},g.createElement(v,{className:i.icon},g.createElement(w,null))),a),n?p.exports.createElement(n):null))};br.propTypes={backgroundImage:_.string,children:_.node,classes:_.object,className:_.string,theme:_.object,staticContext:_.object},br.defaultProps={theme:S,notification:k};var hr=C((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.grey[500]}}})),yr=function(){return(yr=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},vr=function(e){var t=e.meta,r=t.touched,a=t.error,n=e.input,o=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(e,["meta","input"]);return p.exports.createElement(N,yr({error:!(!r||!a),helperText:r&&a},n,o,{fullWidth:!0}))},wr=function(e,t,r,a){return new(r||(r=Promise))((function(n,o){function l(e){try{i(a.next(e))}catch(t){o(t)}}function s(e){try{i(a.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,s)}i((a=a.apply(e,t||[])).next())}))},_r=function(e,t){var r,a,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=l.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(s){o=[6,s],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Sr=function(e){var t=kr(e),r=P(),a=function(e){var t=void 0===e?{}:e,r=t.redirectTo,a=void 0===r?"/":r,n=t.parameterName,o=void 0===n?"access_token":n,l=x(),s=new URLSearchParams(window.location.search.substr(1)).get(o);return p.exports.useEffect((function(){null==s&&!1!==a&&l(a)})),s}(),n=function(e){var t=u(),r=x(),a=f(),n=e||{},o=n.onSuccess,l=void 0===o?function(){return r("/")}:o,s=n.onFailure,i=void 0===s?function(e){return t(e.message,"error")}:s;return function(e){a.setPassword(e).then((function(){l&&l()})).catch((function(e){i&&i(e)}))}}({onSuccess:e.onSuccess,onFailure:e.onFailure});return p.exports.createElement(I,{onSubmit:function(e){return wr(void 0,void 0,void 0,(function(){return _r(this,(function(t){switch(t.label){case 0:return[4,n({access_token:a,password:e.password})];case 1:return t.sent(),[2]}}))}))},validate:function(e){var t={email:void 0,password:void 0};return e.password||(t.password=r("ra.validation.required")),e.confirm_password&&e.confirm_password===e.password||(t.password="Passwords do not match"),t},render:function(e){var a=e.handleSubmit,n=e.submitting;return p.exports.createElement(p.exports.Fragment,null,p.exports.createElement("form",{onSubmit:a,noValidate:!0},p.exports.createElement("div",{className:t.form},p.exports.createElement("div",null,p.exports.createElement(O,{id:"password",name:"password",type:"password",component:vr,label:r("ra.auth.password"),disabled:n,autoComplete:"current-password"})),p.exports.createElement("div",null,p.exports.createElement(O,{id:"confirm_password",name:"confirm_password",type:"password",component:vr,label:r("ra-supabase.auth.confirm_password",{_:"Confirm password"}),disabled:n}))),p.exports.createElement(D,null,p.exports.createElement(T,{variant:"contained",type:"submit",color:"primary",disabled:n,className:t.button},n&&p.exports.createElement(F,{className:t.icon,size:18,thickness:2}),r("ra.auth.sign_in")))))}})},kr=C((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}}),{name:"RaSupabaseSetPasswordForm"}),Cr=function(e){var t=e.children,r=void 0===t?p.exports.createElement(Sr,null):t;return p.exports.createElement(br,null,r)},Nr=[p.exports.createElement(L,{noLayout:!0,path:"/set-password",render:function(){return p.exports.createElement(Cr,null)}})],Pr=function(){var e=Ir(),t=A(),r=u(),a=P();return p.exports.createElement(I,{onSubmit:function(e){return t(e).catch((function(e){r("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=a("ra.validation.required")),e.password||(t.password=a("ra.validation.required")),t},render:function(t){var r=t.handleSubmit,n=t.submitting;return p.exports.createElement("form",{onSubmit:r,noValidate:!0},p.exports.createElement("div",{className:e.form},p.exports.createElement("div",{className:e.input},p.exports.createElement(O,{autoFocus:!0,id:"email",name:"email",type:"email",component:vr,label:a("ra-supabase.auth.email",{_:"Email"}),disabled:n})),p.exports.createElement("div",null,p.exports.createElement(O,{id:"password",name:"password",type:"password",component:vr,label:a("ra.auth.password"),disabled:n,autoComplete:"current-password"}))),p.exports.createElement(D,null,p.exports.createElement(T,{variant:"contained",type:"submit",color:"primary",disabled:n,className:e.button},n&&p.exports.createElement(F,{className:e.icon,size:18,thickness:2}),a("ra.auth.sign_in"))))}})},Ir=C((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}}),{name:"RaSupabaseLoginForm"}),Or=function(e){var t=e.children,r=void 0===t?p.exports.createElement(Pr,null):t;return function(e){void 0===e&&(e="/");var t=m(),r=d();p.exports.useEffect((function(){r({},!1).then((function(){t.push(e)})).catch((function(){}))}),[r,t,e])}(),p.exports.createElement(br,null,r)};const Dr=j("https://ahdkzhzxnqnyhqiiacst.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFoZGt6aHp4bnFueWhxaWlhY3N0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTUyMTMyODgsImV4cCI6MTk3MDc4OTI4OH0.LWxxafWTNkCivJSzbJOQxAsCSNi3iGBrBXQ-xS-FCR4"),Tr=(Fr=Dr,Lr={companies:{fields:["id","name","sector","size","linkedIn","website","phone_number","address","zipcode","city","stateAbbr","nb_contacts","nb_deals","sales_id","created_at"],fullTextSearchFields:["name","sector","website","address","city","stateAbbr"]},contactNotes:{fields:["id","contact_id","type","text","date","sales_id","status"],fullTextSearchFields:["type","text","status"]},contacts:{fields:["id","first_name","last_name","gender","title","company_id","email","phone_number1","phone_number2","background","acquisition","first_seen","last_seen","has_newsletter","status","tags","sales_id","nb_notes"],fullTextSearchFields:["first_name","last_name","gender","title","email","background","acquisition","status"]},dealNotes:{fields:["id","deal_id","type","text","date","sales_id"],fullTextSearchFields:["type","text"]},deals:{fields:["id","name","company_id","contact_ids","type","stage","description","amount","created_at","updated_at","start_at","sales_id","index","nb_notes"],fullTextSearchFields:["name","type","stage","description"]},sales:{fields:["id","first_name","last_name","email"],fullTextSearchFields:["first_name","last_name","email"]},tags:{fields:["id","name","color"],fullTextSearchFields:["name"]},tasks:{fields:["id","contact_id","type","text","due_date","sales_id"],fullTextSearchFields:["type","text"]}},{getList:function(e,t){return ur(void 0,void 0,void 0,(function(){var r;return xr(this,(function(a){return r=Er(e,Lr),[2,fr({client:Fr,resource:e,resourceOptions:r,params:t})]}))}))},getOne:function(e,t){var r=t.id;return ur(void 0,void 0,void 0,(function(){var t,a,n,o;return xr(this,(function(l){switch(l.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).select(t.fields.join(", ")).match({id:r}).single()];case 1:if(a=l.sent(),n=a.data,o=a.error)throw o;return"id"===t.primaryKey?[2,{data:n}]:[2,pr(pr({},n),{id:n[t.primaryKey]})]}}))}))},getMany:function(e,t){var r=t.ids;return ur(void 0,void 0,void 0,(function(){var t,a,n,o;return xr(this,(function(l){switch(l.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).select(t.fields.join(", ")).in("id",r)];case 1:if(a=l.sent(),n=a.data,o=a.error)throw o;return[2,{data:null!=n?n:[]}]}}))}))},getManyReference:function(e,t){return ur(void 0,void 0,void 0,(function(){var r,a,n,o,l;return xr(this,(function(s){return r=Er(e,Lr),a=t.target,n=t.id,o=pr(pr({},t),{filter:pr(pr({},t.filter),(l={},l[a]=n,l))}),[2,fr({client:Fr,resource:e,resourceOptions:r,params:o})]}))}))},create:function(e,t){var r=t.data;return ur(void 0,void 0,void 0,(function(){var t,a,n,o;return xr(this,(function(l){switch(l.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).insert(r).single()];case 1:if(a=l.sent(),n=a.data,o=a.error)throw o;return"id"===t.primaryKey?[2,{data:n}]:[2,pr(pr({},n),{id:n[t.primaryKey]})]}}))}))},update:function(e,t){var r=t.id,a=t.data;return ur(void 0,void 0,void 0,(function(){var t,n,o,l;return xr(this,(function(s){switch(s.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).update(a).match({id:r}).single()];case 1:if(n=s.sent(),o=n.data,l=n.error)throw l;return"id"===t.primaryKey?[2,{data:o}]:[2,pr(pr({},o),{id:o[t.primaryKey]})]}}))}))},updateMany:function(e,t){var r=t.ids,a=t.data;return ur(void 0,void 0,void 0,(function(){var t,n,o,l;return xr(this,(function(s){switch(s.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).update(a).in("id",r)];case 1:if(n=s.sent(),o=n.data,l=n.error)throw l;return[2,{data:null==o?void 0:o.map((function(e){return e[t.primaryKey]}))}]}}))}))},delete:function(e,t){var r=t.id;return ur(void 0,void 0,void 0,(function(){var t,a,n,o;return xr(this,(function(l){switch(l.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).delete().match({id:r}).single()];case 1:if(a=l.sent(),n=a.data,o=a.error)throw o;return"id"===t.primaryKey?[2,{data:n}]:[2,pr(pr({},n),{id:n[t.primaryKey]})]}}))}))},deleteMany:function(e,t){var r=t.ids;return ur(void 0,void 0,void 0,(function(){var t,a,n,o;return xr(this,(function(l){switch(l.label){case 0:return t=Er(e,Lr),[4,Fr.from(t.table).delete().in("id",r)];case 1:if(a=l.sent(),n=a.data,o=a.error)throw o;return[2,{data:null==n?void 0:n.map((function(e){return e[t.primaryKey]}))}]}}))}))}});var Fr,Lr;const Ar=function(e,t){var r=t.getIdentity;return{login:function(t){var r=t.email,a=t.password;return cr(this,void 0,void 0,(function(){var t;return mr(this,(function(n){switch(n.label){case 0:return[4,e.auth.signIn({email:r,password:a})];case 1:if(t=n.sent().error)throw t;return[2,void 0]}}))}))},setPassword:function(t){var r=t.access_token,a=t.password;return cr(this,void 0,void 0,(function(){var t;return mr(this,(function(n){switch(n.label){case 0:return[4,e.auth.api.updateUser(r,{password:a})];case 1:if(t=n.sent().error)throw t;return[2,void 0]}}))}))},logout:function(){return cr(this,void 0,void 0,(function(){var t;return mr(this,(function(r){switch(r.label){case 0:return[4,e.auth.signOut()];case 1:if(t=r.sent().error)throw t;return[2]}}))}))},checkError:function(){return cr(this,void 0,void 0,(function(){return mr(this,(function(e){return[2]}))}))},checkAuth:function(){return cr(this,void 0,void 0,(function(){var t,r,a;return mr(this,(function(n){if("/set-password"===window.location.pathname)return[2];if(t=new URLSearchParams(window.location.hash.substr(1)),r=t.get("access_token"),a=t.get("type"),r&&"recovery"===a)throw new dr("Users have reset their password and must set a new one","set-password?access_token="+r);if(r&&"invite"===a)throw new dr("Users have have been invited and must set their password","set-password?access_token="+r);if(null==e.auth.session())throw new Error;return[2,Promise.resolve()]}))}))},getPermissions:function(){return cr(this,void 0,void 0,(function(){return mr(this,(function(e){return[2]}))}))},getIdentity:function(){return cr(this,void 0,void 0,(function(){var t;return mr(this,(function(a){switch(a.label){case 0:if(!(t=e.auth.user()))throw new Error;return"function"!=typeof r?[3,2]:[4,r(t)];case 1:return[2,a.sent()];case 2:return[2,void 0]}}))}))}}}(Dr,{getIdentity:async e=>{const{data:t,error:r}=await Dr.from("sales").select("id, first_name, last_name").match({email:null==e?void 0:e.email}).single();if(!t||r)throw new Error;return{id:t.id,fullName:`${t.first_name} ${t.last_name}`}}}),jr=C({root:{flexGrow:1},logo:{width:50,height:43.54}}),Wr=()=>{var e;const t=jr(),r=W(["/contacts","/companies","/deals"]),a=null!=(e=null==r?void 0:r.path)?e:"/";return g.createElement("nav",{className:t.root},g.createElement(z,{position:"static",color:"primary"},g.createElement(B,{variant:"dense"},g.createElement($,{flex:1,display:"flex",justifyContent:"space-between"},g.createElement($,{display:"flex",alignItems:"center"},g.createElement("img",{className:t.logo,src:"https://upload.wikimedia.org/wikipedia/commons/a/a7/React-icon.svg",alt:"Bosch Logo"}),g.createElement(R,{component:"span",variant:"h5"},"Atomic CRM")),g.createElement($,null,g.createElement(M,{value:a,"aria-label":"Navigation Tabs"},g.createElement(V,{label:"Dashboard",component:U,to:"/",value:"/"}),g.createElement(V,{label:"Contacts",component:U,to:"/contacts",value:"/contacts"}),g.createElement(V,{label:"Companies",component:U,to:"/companies",value:"/companies"}),g.createElement(V,{label:"Deals",component:U,to:"/deals",value:"/deals"}))),g.createElement($,{display:"flex",alignItems:"center"},g.createElement(K,null),g.createElement(q,{logout:g.createElement(H,{button:!0})}))))))};class zr extends p.exports.Component{constructor(e){super(e),this.state={hasError:!1,errorMessage:void 0,errorInfo:void 0},e.history.listen((()=>{this.state.hasError&&this.setState({hasError:!1})}))}componentDidCatch(e,t){this.setState({hasError:!0,errorMessage:e.message,errorInfo:t})}render(){const{theme:e,title:t,children:r}=this.props,{hasError:a,errorMessage:n,errorInfo:o}=this.state;return g.createElement(b,{theme:J(e)},g.createElement(X,null),g.createElement(Wr,null),g.createElement(Y,null,g.createElement("main",{id:"main-content"},a?g.createElement(Z,{error:n,errorInfo:o,title:t}):r)),g.createElement(k,null))}}zr.propTypes={children:_.oneOfType([_.func,_.node]),title:_.node.isRequired};var Br=G(zr);const $r=({record:e})=>p.exports.createElement(v,{src:e.avatar},e.first_name.charAt(0),e.last_name.charAt(0)),Rr=["#eddcd2","#fff1e6","#fde2e4","#fad2e1","#c5dedd","#dbe7e4","#f0efeb","#d6e2e9","#bcd4e6","#99c1de"],Mr=({record:e})=>{const[t,r]=p.exports.useState(!1),[a,n]=p.exports.useState(""),[o,l]=p.exports.useState(Rr[0]),[s,i]=p.exports.useState(null),[c,m]=p.exports.useState(0),[d,u]=p.exports.useState(!1),{data:x,ids:f}=Q("tags",{page:1,perPage:10},{field:"name",order:"ASC"},{},{version:c}),{data:E,loaded:g}=ee("tags",e.tags,{enabled:e.tags&&e.tags.length>0}),[b]=te(),[h]=re(),y=f&&f.filter((t=>!e.tags.includes(t))),v=t=>{const r=[...e.tags,t];b("contacts",e.id,{tags:r},e),i(null)},w=()=>{r(!0),i(null),u(!1)};return g&&E?p.exports.createElement(p.exports.Fragment,null,E.map((t=>p.exports.createElement($,{mt:1,mb:1,key:t.id},p.exports.createElement(ae,{size:"small",variant:"outlined",onDelete:()=>(t=>{const r=e.tags.filter((e=>e!==t));b("contacts",e.id,{tags:r},e)})(t.id),label:t.name,style:{backgroundColor:t.color,border:0}})))),p.exports.createElement($,{mt:1},p.exports.createElement(ae,{icon:p.exports.createElement(ne,null),size:"small",variant:"outlined",onClick:e=>{i(e.currentTarget)},label:"Add tag",color:"primary"})),p.exports.createElement(oe,{open:Boolean(s),onClose:()=>{i(null)},anchorEl:s},null==y?void 0:y.map((e=>p.exports.createElement(le,{key:e,onClick:()=>v(e)},p.exports.createElement(ae,{size:"small",variant:"outlined",label:x&&x[e].name,style:{backgroundColor:x&&x[e].color,border:0},onClick:()=>v(e)})))),p.exports.createElement(le,{onClick:w},p.exports.createElement(ae,{icon:p.exports.createElement(se,null),size:"small",variant:"outlined",onClick:w,color:"primary",label:"Create new tag"}))),p.exports.createElement(ie,{open:t,onClose:()=>r(!1),"aria-labelledby":"form-dialog-title"},p.exports.createElement("form",{onSubmit:t=>{t.preventDefault(),u(!0),h("tags",{name:a,color:o},{onSuccess:({data:t})=>{b("contacts",e.id,{tags:[...e.tags,t.id]},e,{onSuccess:()=>{n(""),l(Rr[0]),r(!1),m((e=>e+1))}})}})}},p.exports.createElement(ce,{id:"form-dialog-title"},"Create a new tag"),p.exports.createElement(me,null,p.exports.createElement(N,{autoFocus:!0,label:"Tag name",fullWidth:!0,value:a,onChange:e=>{n(e.target.value)}}),p.exports.createElement($,{display:"flex",flexWrap:"wrap",width:230,mt:2},Rr.map((e=>p.exports.createElement(Ur,{key:e,color:e,selected:e===o,handleClick:()=>{l(e)}}))))),p.exports.createElement(de,null,p.exports.createElement(T,{onClick:()=>r(!1),color:"primary"},"Cancel"),p.exports.createElement(T,{type:"submit",color:"primary",disabled:d},"Add tag"))))):null},Vr=C({root:{width:30,height:30,borderRadius:15,display:"inline-block",margin:8}}),Ur=({color:e,handleClick:t,selected:r})=>{const a=Vr();return p.exports.createElement("button",{type:"button",className:a.root,style:{backgroundColor:e,border:r?"2px solid grey":"none"},onClick:t})},Kr=({record:e,link:t="edit"})=>p.exports.createElement($,{ml:4,width:250,minWidth:250},p.exports.createElement($,{textAlign:"center",mb:2},"edit"===t?p.exports.createElement(pe,{basePath:"/contacts",record:e,label:"Edit Contact"}):p.exports.createElement(ue,{basePath:"/contacts",record:e,label:"Show Contact"})),p.exports.createElement(R,{variant:"subtitle2"},"Personal info"),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2},p.exports.createElement(fe,{source:"email"})),p.exports.createElement($,{mt:1},p.exports.createElement(Ee,{source:"phone_number1"})," ",p.exports.createElement(R,{variant:"body2",color:"textSecondary",component:"span"},"Work")),p.exports.createElement($,{mb:1},p.exports.createElement(Ee,{source:"phone_number2"})," ",p.exports.createElement(R,{variant:"body2",color:"textSecondary",component:"span"},"Home")),p.exports.createElement($,{mb:3},p.exports.createElement(R,{variant:"body2"},"male"===e.gender?"He/Him":"She/Her")),p.exports.createElement(R,{variant:"subtitle2"},"Background"),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2},e&&e.background),p.exports.createElement($,{mt:1,mb:3},p.exports.createElement(R,{component:"span",variant:"body2",color:"textSecondary"},"Added on")," ",p.exports.createElement(ge,{source:"first_seen",options:{year:"numeric",month:"long",day:"numeric"},color:"textSecondary"}),p.exports.createElement("br",null),p.exports.createElement(R,{component:"span",variant:"body2",color:"textSecondary"},"Last seen on")," ",p.exports.createElement(ge,{source:"last_seen",options:{year:"numeric",month:"long",day:"numeric"},color:"textSecondary"}),p.exports.createElement("br",null),p.exports.createElement(R,{component:"span",variant:"body2",color:"textSecondary"},"Followed by")," ",p.exports.createElement(be,{resource:"contacts",source:"sales_id",reference:"sales"},p.exports.createElement(he,{source:"last_name",render:e=>e?`${e.first_name} ${e.last_name}`:""}))),p.exports.createElement($,{mb:3},p.exports.createElement(R,{variant:"subtitle2"},"Tags"),p.exports.createElement(xe,null),p.exports.createElement(Mr,{record:e})),p.exports.createElement(ye,{resource:"contacts",target:"contact_id",reference:"tasks"},p.exports.createElement(qr,null))),qr=()=>{const{data:e,ids:t,loading:r}=ve();return r||0===t.length?null:p.exports.createElement($,null,p.exports.createElement(R,{variant:"subtitle2"},"Tasks"),p.exports.createElement(xe,null),p.exports.createElement(we,null,t.map((t=>{const r=e[t];return p.exports.createElement(_e,{key:t,disableGutters:!0},p.exports.createElement($,null,p.exports.createElement(R,{variant:"body2"},r.text),p.exports.createElement(R,{variant:"body2",color:"textSecondary"},"due"," ",p.exports.createElement(ge,{source:"due_date",record:r}))))}))))},Hr=C({avatar:{width:60,height:60,backgroundColor:"aliceblue"},image:{objectFit:"contain"},small:{width:20,height:20},medium:{width:30,height:30},large:{width:40,height:40}}),Gr=({record:e,source:t,size:r="medium"})=>{const a=Hr();return e?p.exports.createElement(v,{src:e.logo,alt:e.name,title:e.name,className:a.image,imgProps:{className:Se(a.image,a[r])}}):null},Jr=e=>"cold"===e?"#7dbde8":"warm"===e?"#e8cb7d":"hot"===e?"#e88b7d":"in-contract"===e?"#a4e87d":"#000",Xr=({status:e})=>p.exports.createElement($,{width:10,height:10,display:"inline-block",borderRadius:5,bgcolor:Jr(e),component:"span"}),Yr=C({root:{width:150}}),Zr=({status:e,setStatus:t,className:r=""})=>{const a=Yr();return p.exports.createElement(N,{select:!0,value:e,onChange:e=>{t(e.target.value)},variant:"filled",label:!1,margin:"none",size:"small",className:Se(r,a.root)},p.exports.createElement(le,{value:"cold"},"Cold ",p.exports.createElement(Xr,{status:"cold"})),p.exports.createElement(le,{value:"warm"},"Warm ",p.exports.createElement(Xr,{status:"warm"})),p.exports.createElement(le,{value:"hot"},"Hot ",p.exports.createElement(Xr,{status:"hot"})),p.exports.createElement(le,{value:"in-contract"},"In Contract ",p.exports.createElement(Xr,{status:"in-contract"})))},Qr=C((e=>({root:{marginTop:e.spacing(4),marginBottom:e.spacing(1)},toolbar:{display:"flex",justifyContent:"space-between",marginTop:e.spacing(1)},small:{marginRight:"1em","& .MuiFilledInput-input":{paddingTop:10}}}))),ea=({showStatus:e,reference:t})=>{const r=Qr(),a=ke(),n=Ce(),[o,l]=p.exports.useState(""),[s,i]=p.exports.useState(a&&a.status),[c,m]=p.exports.useState(ta()),[d,{loading:x}]=re(),[f]=te(),E=Ne(),g=u(),{identity:b}=Pe();if(!a||!b)return null;return p.exports.createElement("div",{className:r.root},p.exports.createElement("form",{onSubmit:r=>{r.preventDefault();const i={[ra[t]]:a.id,sales_id:b.id,date:c,text:o};return e&&(i.status=s),f(t,a&&a.id,{last_seen:c,status:s,nb_notes:a.nb_notes+1},a),d(n,i,{onSuccess:()=>{l(""),g("Note added successfully"),E()}}),!1}},p.exports.createElement(N,{label:"Add a note",variant:"filled",size:"small",fullWidth:!0,multiline:!0,value:o,onChange:e=>l(e.target.value),rows:3}),p.exports.createElement("div",{className:r.toolbar},p.exports.createElement("span",null,o?p.exports.createElement(p.exports.Fragment,null,e&&p.exports.createElement(Zr,{status:s,setStatus:i,className:r.small}),p.exports.createElement(N,{type:"datetime-local",variant:"filled",size:"small",value:c,onChange:e=>{m(e.target.value)},className:r.small})):null),p.exports.createElement(T,{type:"submit",variant:"contained",color:"primary",disabled:!o||x},"Add this note"))))},ta=()=>{const e=new Date;return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,-1)},ra={contacts:"contact_id",deals:"deal_id"},aa=C((e=>({root:{marginBottom:e.spacing(2)},metadata:{marginBottom:e.spacing(1),color:e.palette.text.secondary},textarea:{paddingTop:16,paddingLeft:14,paddingRight:60,paddingBottom:14,lineHeight:1.3},buttons:{display:"flex",justifyContent:"flex-end",marginTop:e.spacing(1)},cancel:{marginRight:e.spacing(1)},content:{backgroundColor:"#edf3f0",padding:"0 1em",borderRadius:10,display:"flex",alignItems:"stretch",marginBottom:e.spacing(1)},text:{flex:1},paragraph:{fontFamily:e.typography.fontFamily,fontSize:e.typography.body1.fontSize,lineHeight:1.3,marginBottom:e.spacing(2.4)},toolbar:{marginLeft:e.spacing(2),visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-around"}}))),na=({showStatus:e,note:t,isLast:r,reference:a})=>{const[n,o]=p.exports.useState(!1),[l,s]=p.exports.useState(!1),[i,c]=p.exports.useState(t.text),m=Ce(),d=ke(),x=u(),f=aa(),[E,{loading:g}]=te(),[b]=Ie(m,t.id,t,{mutationMode:"undoable",onSuccess:()=>{x("Note deleted",void 0,void 0,!0),E(a,d.id,{nb_notes:d.nb_notes-1},d)}});return p.exports.createElement("div",{className:f.root,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)},p.exports.createElement("div",{className:f.metadata},p.exports.createElement(be,{record:t,resource:"contactNotes",source:"sales_id",reference:"sales",basePath:"/contactNotes"},p.exports.createElement(Ee,{source:"first_name",variant:"body1"}))," ",p.exports.createElement(R,{component:"span",variant:"body1"},"added a note on"," "),p.exports.createElement(ge,{source:"date",record:t,variant:"body1",showTime:!0,locales:"en",options:{dateStyle:"full",timeStyle:"short"}})," ",e&&p.exports.createElement(Xr,{status:t.status})),l?p.exports.createElement("form",{onSubmit:e=>{e.preventDefault(),E(m,t.id,{text:i},t,{onSuccess:()=>{s(!1),c(t.text),o(!1)}})}},p.exports.createElement(Oe,{value:i,onChange:e=>{c(e.target.value)},fullWidth:!0,multiline:!0,className:f.textarea,autoFocus:!0}),p.exports.createElement("div",{className:f.buttons},p.exports.createElement(T,{className:f.cancel,onClick:()=>{s(!1),c(t.text),o(!1)},color:"primary"},"Cancel"),p.exports.createElement(T,{type:"submit",color:"primary",variant:"contained",disabled:g},"Update Note"))):p.exports.createElement("div",{className:f.content},p.exports.createElement("div",{className:f.text},t.text.split("\n").map(((e,t)=>p.exports.createElement("p",{className:f.paragraph,key:t},e)))),p.exports.createElement("div",{className:f.toolbar,style:{visibility:n?"visible":"hidden"}},p.exports.createElement(De,{title:"Edit note"},p.exports.createElement(Te,{size:"small",onClick:()=>{s(!0)}},p.exports.createElement(se,null))),p.exports.createElement(De,{title:"Delete note"},p.exports.createElement(Te,{size:"small",onClick:b},p.exports.createElement(Fe,null))))))},oa=C({root:{marginTop:"0.5em"}}),la=({showStatus:e,reference:t})=>{const r=oa(),{data:a,ids:n,loaded:o}=ve();return o?p.exports.createElement(p.exports.Fragment,null,p.exports.createElement(ea,{showStatus:e,reference:t}),p.exports.createElement("div",{className:r.root},n.map(((r,o)=>p.exports.createElement(na,{note:a[r],isLast:o===n.length-1,showStatus:e,reference:t,key:o}))))):null},sa=()=>{const{record:e,loaded:t}=Ae();return t&&e?p.exports.createElement($,{mt:2,display:"flex"},p.exports.createElement($,{flex:"1"},p.exports.createElement(y,null,p.exports.createElement(je,null,p.exports.createElement($,{display:"flex"},p.exports.createElement($r,{record:e}),p.exports.createElement($,{ml:2,flex:"1"},p.exports.createElement(R,{variant:"h5"},e.first_name," ",e.last_name),p.exports.createElement(R,{variant:"body2"},e.title," at"," ",p.exports.createElement(be,{source:"company_id",reference:"companies",link:"show"},p.exports.createElement(Ee,{source:"name"})))),p.exports.createElement($,null,p.exports.createElement(be,{source:"company_id",reference:"companies",link:"show"},p.exports.createElement(Gr,null)))),p.exports.createElement(ye,{target:"contact_id",reference:"contactNotes",sort:{field:"date",order:"DESC"}},p.exports.createElement(la,{showStatus:!0,reference:"contacts"}))))),p.exports.createElement(Kr,{record:e})):null},ia=e=>{var t=e,{record:r}=t,a=c(t,["record"]);return r?p.exports.createElement(Be,i(s({record:r},a),{style:{backgroundColor:r.color,border:0},component:"span"})):null},ca=C({root:{display:"inline-block"}}),ma=({record:e})=>{const t=ca();return e?p.exports.createElement(We,{record:e,basePath:"/contacts",resource:"contacts",source:"tags",reference:"tags",className:t.root},p.exports.createElement(ze,{linkType:!1,component:"span"},p.exports.createElement(ia,{source:"name",variant:"outlined",size:"small"}))):null},da=()=>{const{identity:e}=Pe(),{data:t,ids:r}=Q("tags",{page:1,perPage:10},{field:"name",order:"ASC"});return p.exports.createElement($,{width:"15em",order:"-1",marginRight:"1em"},p.exports.createElement($e,null),p.exports.createElement(Re,{label:"Last seen",icon:p.exports.createElement(Me,null)},p.exports.createElement(Ve,{label:"Today",value:{last_seen_gte:Ue().toISOString(),last_seen_lte:void 0}}),p.exports.createElement(Ve,{label:"This week",value:{last_seen_gte:Ke(new Date).toISOString(),last_seen_lte:void 0}}),p.exports.createElement(Ve,{label:"Before this week",value:{last_seen_gte:void 0,last_seen_lte:Ke(new Date).toISOString()}}),p.exports.createElement(Ve,{label:"Before this month",value:{last_seen_gte:void 0,last_seen_lte:qe(new Date).toISOString()}}),p.exports.createElement(Ve,{label:"Before last month",value:{last_seen_gte:void 0,last_seen_lte:He(qe(new Date),1).toISOString()}})),p.exports.createElement(Re,{label:"Status",icon:p.exports.createElement(Ge,null)},p.exports.createElement(Ve,{label:p.exports.createElement(p.exports.Fragment,null,"Cold ",p.exports.createElement(Xr,{status:"cold"})),value:{status:"cold"}}),p.exports.createElement(Ve,{label:p.exports.createElement(p.exports.Fragment,null,"Warm ",p.exports.createElement(Xr,{status:"warm"})),value:{status:"warm"}}),p.exports.createElement(Ve,{label:p.exports.createElement(p.exports.Fragment,null,"Hot ",p.exports.createElement(Xr,{status:"hot"})),value:{status:"hot"}}),p.exports.createElement(Ve,{label:p.exports.createElement(p.exports.Fragment,null,"In contract ",p.exports.createElement(Xr,{status:"in-contract"})),value:{status:"in-contract"}})),p.exports.createElement(Re,{label:"Tags",icon:p.exports.createElement(Je,null)},r&&t&&r.map((e=>{var r,a;return p.exports.createElement(Ve,{key:e,label:p.exports.createElement(ae,{label:null==(r=t[e])?void 0:r.name,size:"small",style:{backgroundColor:null==(a=t[e])?void 0:a.color,border:0,cursor:"pointer"}}),value:{tags:[e]}})}))),p.exports.createElement(Re,{label:"Account manager",icon:p.exports.createElement(Xe,null)},p.exports.createElement(Ve,{label:"Me",value:{sales_id:e&&e.id}})))},pa=()=>{const{data:e,ids:t,loaded:r,onToggleItem:a,selectedIds:n}=ve(),o=Date.now();return!1===r?p.exports.createElement(Qe,{hasLeftAvatarOrIcon:!0,hasSecondaryText:!0}):p.exports.createElement(we,null,t.map((t=>{const r=e[t];return p.exports.createElement(_e,{button:!0,key:t,component:U,to:`/contacts/${t}/show`},p.exports.createElement(et,null,p.exports.createElement(tt,{edge:"start",checked:n.includes(t),tabIndex:-1,disableRipple:!0,onClick:e=>{e.stopPropagation(),a(t)}})),p.exports.createElement(rt,null,p.exports.createElement($r,{record:r})),p.exports.createElement(at,{primary:`${r.first_name} ${r.last_name}`,secondary:p.exports.createElement(p.exports.Fragment,null,r.title," at"," ",p.exports.createElement(be,{record:r,source:"company_id",reference:"companies",basePath:"/companies",link:!1},p.exports.createElement(Ee,{source:"name"}))," ",r.nb_notes&&`- ${r.nb_notes} notes `,p.exports.createElement(ma,{record:r}))}),p.exports.createElement(nt,null,p.exports.createElement(R,{variant:"body2",color:"textSecondary"},"last activity"," ",ot(new Date(r.last_seen),o)," ","ago ",p.exports.createElement(Xr,{status:r.status}))))})))},ua=C((e=>({createButton:{marginLeft:e.spacing(2)}}))),xa=()=>{const e=ua();return p.exports.createElement(lt,null,p.exports.createElement(st,{fields:["last_name","first_name","last_seen"]}),p.exports.createElement(it,null),p.exports.createElement(ct,{basePath:"/contacts",variant:"contained",label:"New Contact",className:e.createButton}))},fa=()=>p.exports.createElement($,{width:20,component:"span"}),Ea=()=>{const{record:e,loaded:t,save:r}=dt();return t&&e?p.exports.createElement($,{mt:2,display:"flex"},p.exports.createElement($,{flex:"1"},p.exports.createElement(pt,{record:e,redirect:"show",save:r,render:t=>p.exports.createElement(y,null,p.exports.createElement(je,null,p.exports.createElement($,null,p.exports.createElement($,{display:"flex"},p.exports.createElement($,{mr:2},p.exports.createElement($r,{record:e})),p.exports.createElement($,{flex:"1",mt:-1},p.exports.createElement($,{display:"flex"},p.exports.createElement(ut,{source:"first_name"}),p.exports.createElement(fa,null),p.exports.createElement(ut,{source:"last_name"})),p.exports.createElement($,{display:"flex"},p.exports.createElement(ut,{source:"title"}),p.exports.createElement(fa,null),p.exports.createElement(xt,{source:"company_id",reference:"companies"},p.exports.createElement(ft,{optionText:"name"}))),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2,width:430},p.exports.createElement(ut,{source:"email",fullWidth:!0})),p.exports.createElement($,{display:"flex"},p.exports.createElement(ut,{source:"phone_number1"}),p.exports.createElement(fa,null),p.exports.createElement(ut,{source:"phone_number2"})),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2,width:430},p.exports.createElement(ut,{source:"background",multiline:!0,fullWidth:!0}),p.exports.createElement(ut,{source:"avatar",fullWidth:!0}),p.exports.createElement(Et,{source:"has_newsletter"})))))),p.exports.createElement(gt,s({},bt(t,["dirtyFields","dirtyFieldsSinceLastSubmit","dirtySinceLastSubmit","hasSubmitErrors","hasValidationErrors","initialValues","modifiedSinceLastSubmit","submitError","submitErrors","submitFailed","submitSucceeded","submitting","valid"]))))})),p.exports.createElement(Kr,{record:e,link:"show"})):null},ga=()=>p.exports.createElement($,{width:20,component:"span"}),ba=()=>{const{identity:e}=Pe(),{save:t,record:r}=yt();return p.exports.createElement($,{mt:2,display:"flex"},p.exports.createElement($,{flex:"1"},p.exports.createElement(pt,{redirect:"show",record:r,save:t,initialValues:{sales_id:null==e?void 0:e.id},render:e=>p.exports.createElement(y,null,p.exports.createElement(je,null,p.exports.createElement($,null,p.exports.createElement($,{display:"flex"},p.exports.createElement($,{mr:2},p.exports.createElement(v,null)),p.exports.createElement($,{flex:"1",mt:-1},p.exports.createElement($,{display:"flex"},p.exports.createElement(ut,{source:"first_name",validate:[vt()]}),p.exports.createElement(ga,null),p.exports.createElement(ut,{source:"last_name",validate:[vt()]})),p.exports.createElement($,{display:"flex"},p.exports.createElement(ut,{source:"title"}),p.exports.createElement(ga,null),p.exports.createElement(xt,{source:"company_id",reference:"companies"},p.exports.createElement(ft,{optionText:"name"}))),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2,width:430},p.exports.createElement(ut,{source:"email",fullWidth:!0})),p.exports.createElement($,{display:"flex"},p.exports.createElement(ut,{source:"phone_number1"}),p.exports.createElement(ga,null),p.exports.createElement(ut,{source:"phone_number2"})),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2,width:430},p.exports.createElement(ut,{source:"background",multiline:!0,fullWidth:!0}),p.exports.createElement(ut,{source:"avatar",fullWidth:!0}),p.exports.createElement(Et,{source:"has_newsletter"})))))),p.exports.createElement(gt,s({},e)))})))};var ha={list:e=>{const{identity:t}=Pe();return t?p.exports.createElement(Ye,i(s({},e),{actions:p.exports.createElement(xa,null),aside:p.exports.createElement(da,null),perPage:25,pagination:p.exports.createElement(Ze,{rowsPerPageOptions:[10,25,50,100]}),filterDefaultValues:{sales_id:null==t?void 0:t.id},sort:{field:"last_seen",order:"DESC"}}),p.exports.createElement(pa,null)):null},show:e=>p.exports.createElement(Le,s({},e),p.exports.createElement(sa,null)),edit:e=>p.exports.createElement(mt,s({},e),p.exports.createElement(Ea,null)),create:e=>p.exports.createElement(ht,i(s({},e),{transform:e=>i(s({},e),{last_seen:new Date,tags:[]})}),p.exports.createElement(ba,null))};const ya=["Tech for good","Not text for good"].map((e=>({id:e,name:e}))),va=C({avatar:{width:60,height:60,backgroundColor:"aliceblue"},img:{objectFit:"contain"},small:{width:20,height:20},medium:{width:30,height:30},large:{width:40,height:40}}),wa=({record:e,size:t="large"})=>{const r=va();return e?p.exports.createElement(v,{src:e.logo,alt:e.name,className:r.avatar,imgProps:{className:Se(r.img,r[t])}}):null},_a=C((e=>({paper:{height:200,width:193.5,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"1em"},identity:{display:"flex",flexDirection:"column",alignItems:"center"},name:{textAlign:"center",marginTop:e.spacing(1)},stats:{display:"flex",justifyContent:"space-around",width:"100%"},singleStat:{display:"flex",alignItems:"center"},statIcon:{marginRight:e.spacing(1)}}))),Sa=({record:e})=>{const t=_a(),[r,a]=p.exports.useState(1);return p.exports.createElement(wt,{component:U,to:_t("/companies",e.id,"show"),underline:"none",onMouseEnter:()=>a(3),onMouseLeave:()=>a(1)},p.exports.createElement(St,{className:t.paper,elevation:r},p.exports.createElement("div",{className:t.identity},p.exports.createElement(wa,{record:e}),p.exports.createElement("div",{className:t.name},p.exports.createElement(R,{variant:"subtitle2"},e.name),p.exports.createElement(kt,{color:"textSecondary",source:"sector",choices:ya,record:e}))),p.exports.createElement("div",{className:t.stats},p.exports.createElement("div",{className:t.singleStat},p.exports.createElement(Ct,{color:"disabled",className:t.statIcon}),p.exports.createElement("div",null,p.exports.createElement(R,{variant:"subtitle2",style:{marginBottom:-8}},e.nb_contacts),p.exports.createElement(R,{variant:"caption",color:"textSecondary"},e.nb_contacts>1?"contacts":"contact"))),p.exports.createElement("div",{className:t.singleStat},p.exports.createElement(Nt,{color:"disabled",className:t.statIcon}),p.exports.createElement("div",null,p.exports.createElement(R,{variant:"subtitle2",style:{marginBottom:-8}},e.nb_deals),p.exports.createElement(R,{variant:"caption",color:"textSecondary"},e.nb_deals>1?"deals":"deal"))))))},ka=C((e=>({gridList:{display:"flex",flexWrap:"wrap",width:1008,gap:"10px"},paper:{height:200,width:194,display:"flex",flexDirection:"column",backgroundColor:e.palette.grey[200]}}))),Ca=()=>{const e=ka();return p.exports.createElement($,{className:e.gridList},(t=15,r=t=>p.exports.createElement(St,{className:e.paper,key:t}),Array.from({length:t},((e,t)=>r(t)))));var t,r},Na=()=>{const{ids:e,data:t}=ve(),r=ka();return e&&t?p.exports.createElement($,{className:r.gridList},e.map((e=>p.exports.createElement(Sa,{key:e,record:t[e]})))):null},Pa=()=>{const{loaded:e}=ve();return e?p.exports.createElement(Na,null):p.exports.createElement(Ca,null)},Ia=[{id:1,name:"1 employee"},{id:10,name:"2-9 employees"},{id:50,name:"10-49 employees"},{id:250,name:"50-249 employees"},{id:500,name:"250 or more employees"}],Oa=()=>{const{identity:e}=Pe();return p.exports.createElement($,{width:"15em",order:"-1",marginRight:"1em"},p.exports.createElement($e,null),p.exports.createElement(Re,{label:"Size",icon:p.exports.createElement(Pt,null)},Ia.map((e=>p.exports.createElement(Ve,{key:e.id,label:e.name,value:{size:e.id}})))),p.exports.createElement(Re,{label:"Sector",icon:p.exports.createElement(It,null)},ya.map((e=>p.exports.createElement(Ve,{key:e.id,label:e.name,value:{sector:e.id}})))),p.exports.createElement(Re,{label:"Account manager",icon:p.exports.createElement(Xe,null)},p.exports.createElement(Ve,{label:"Me",value:{sales_id:e&&e.id}})))},Da=C((e=>({createButton:{marginLeft:e.spacing(2)}}))),Ta=e=>{const t=Da();return p.exports.createElement(lt,null,p.exports.createElement(it,null),p.exports.createElement(ct,{basePath:"/companies",variant:"contained",label:"New Company",className:t.createButton}))},Fa=C({inline:{display:"inline-block",marginLeft:"1em","&.first-child":{marginLeft:0}}}),La=e=>p.exports.createElement(je,null,p.exports.createElement($,{display:"flex"},p.exports.createElement($,{paddingTop:1},p.exports.createElement(v,null,p.exports.createElement(Pt,null))),p.exports.createElement($,{ml:2,flex:"1",maxWidth:796},e.children))),Aa=()=>p.exports.createElement($,{mb:2},p.exports.createElement(xe,null)),ja=({record:e,link:t="edit"})=>e?p.exports.createElement($,{ml:4,width:250,minWidth:250},p.exports.createElement($,{textAlign:"center",mb:2},"edit"===t?p.exports.createElement(pe,{basePath:"/companies",record:e,label:"Edit Company"}):p.exports.createElement(ue,{basePath:"/companies",record:e,label:"Show Company"})),p.exports.createElement(R,{variant:"subtitle2"},"Company info"),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2},"Website: ",p.exports.createElement(wt,{href:e.website},e.website),p.exports.createElement("br",null),"LinkedIn: ",p.exports.createElement(wt,{href:e.linkedIn},"LinkedIn")),p.exports.createElement($,{mt:1},p.exports.createElement(Ee,{source:"phone_number",record:e})," ",p.exports.createElement(R,{variant:"body2",color:"textSecondary",component:"span"},"Main")),p.exports.createElement($,{mt:1,mb:3},p.exports.createElement(Ee,{source:"address"}),p.exports.createElement("br",null),p.exports.createElement(Ee,{source:"city"})," ",p.exports.createElement(Ee,{source:"zipcode"})," ",p.exports.createElement(Ee,{source:"stateAbbr"})),p.exports.createElement(R,{variant:"subtitle2"},"Background"),p.exports.createElement(xe,null),p.exports.createElement($,{mt:1},p.exports.createElement(R,{variant:"body2",color:"textSecondary",component:"span"},"Added on")," ",p.exports.createElement(ge,{source:"created_at",options:{year:"numeric",month:"long",day:"numeric"},color:"textSecondary"}),p.exports.createElement("br",null),p.exports.createElement(R,{component:"span",variant:"body2",color:"textSecondary"},"Followed by")," ",p.exports.createElement(be,{resource:"companies",source:"sales_id",reference:"sales"},p.exports.createElement(he,{source:"last_name",render:e=>e?`${e.first_name} ${e.last_name}`:""})))):null,Wa=["opportunity","proposal-sent","in-negociation","won","lost","delayed"],za={opportunity:"Opportunity","proposal-sent":"Proposal Sent","in-negociation":"In Negociation",won:"Won",lost:"Lost",delayed:"Delayed"},Ba=Wa.map((e=>({id:e,name:za[e]}))),$a=()=>{const{record:e,loaded:t}=Ae(),[r,a]=p.exports.useState(0);return t&&e?p.exports.createElement($,{mt:2,display:"flex"},p.exports.createElement($,{flex:"1"},p.exports.createElement(y,null,p.exports.createElement(je,null,p.exports.createElement($,{display:"flex",mb:1},p.exports.createElement(Gr,{record:e}),p.exports.createElement($,{ml:2,flex:"1"},p.exports.createElement(R,{variant:"h5"},e.name),p.exports.createElement(R,{variant:"body2"},p.exports.createElement(Ee,{source:"sector"}),","," ",p.exports.createElement(kt,{source:"size",choices:Ia})))),p.exports.createElement(M,{value:r,indicatorColor:"primary",textColor:"primary",onChange:(e,t)=>{a(t)}},e.nb_contacts&&p.exports.createElement(V,{label:1===e.nb_contacts?"1 Contact":`${e.nb_contacts} Contacts`}),e.nb_deals&&p.exports.createElement(V,{label:1===e.nb_deals?"1 deal":`${e.nb_deals} Deals`})),p.exports.createElement(xe,null),p.exports.createElement(Ra,{value:r,index:0},p.exports.createElement(ye,{reference:"contacts",target:"company_id",sort:{field:"last_name",order:"ASC"}},p.exports.createElement(Ma,null))),p.exports.createElement(Ra,{value:r,index:1},p.exports.createElement(ye,{reference:"deals",target:"company_id",sort:{field:"name",order:"ASC"}},p.exports.createElement(Ua,null)))))),p.exports.createElement(ja,{record:e})):null},Ra=e=>{const t=e,{children:r,value:a,index:n}=t,o=c(t,["children","value","index"]);return p.exports.createElement("div",s({role:"tabpanel",hidden:a!==n,id:`wrapped-tabpanel-${n}`,"aria-labelledby":`wrapped-tab-${n}`},o),r)},Ma=()=>{const{data:e,ids:t,loaded:r}=ve(),a=ke(),n=Date.now();return r?p.exports.createElement($,null,p.exports.createElement(we,null,t.map((t=>{const r=e[t];return p.exports.createElement(_e,{button:!0,key:t,component:U,to:`/contacts/${t}/show`},p.exports.createElement(rt,null,p.exports.createElement($r,{record:r})),p.exports.createElement(at,{primary:`${r.first_name} ${r.last_name}`,secondary:p.exports.createElement(p.exports.Fragment,null,r.title," ",p.exports.createElement(ma,{record:r}))}),p.exports.createElement(nt,null,p.exports.createElement(R,{variant:"body2",color:"textSecondary",component:"span"},"last activity"," ",ot(new Date(r.last_seen),n)," ","ago ",p.exports.createElement(Xr,{status:r.status}))))}))),p.exports.createElement($,{textAlign:"center",mt:1},p.exports.createElement(Va,{record:a}))):null},Va=({record:e})=>p.exports.createElement(T,{component:U,to:{pathname:"/contacts/create",state:{record:{company_id:e.id}}},color:"primary",variant:"contained",size:"small",startIcon:p.exports.createElement(Ft,null)},"Add contact"),Ua=()=>{const{data:e,ids:t,loaded:r}=ve(),a=Date.now();return r?p.exports.createElement($,null,p.exports.createElement(we,null,t.map((t=>{const r=e[t];return p.exports.createElement(_e,{button:!0,key:t,component:U,to:`/deals/${t}/show`},p.exports.createElement(at,{primary:r.name,secondary:p.exports.createElement(p.exports.Fragment,null,za[r.stage],","," ",r.amount.toLocaleString("en-US",{notation:"compact",style:"currency",currency:"USD",currencyDisplay:"narrowSymbol",minimumSignificantDigits:3}),", ",r.type)}),p.exports.createElement(nt,null,p.exports.createElement(R,{variant:"body2",color:"textSecondary",component:"span"},"last activity"," ",ot(new Date(r.updated_at),a)," ","ago"," ")))})))):null},Ka=C({inline:{display:"inline-block",marginLeft:"1em","&.first-child":{marginLeft:0}}}),qa=e=>{const t=ke(e);return p.exports.createElement(je,null,p.exports.createElement($,{display:"flex"},p.exports.createElement(Gr,{record:t}),p.exports.createElement($,{ml:2,flex:"1",maxWidth:796},e.children)))},Ha=()=>p.exports.createElement($,{mb:2},p.exports.createElement(xe,null));var Ga={list:e=>{const{identity:t}=Pe();return console.log({identity:t}),t?p.exports.createElement(Ye,i(s({},e),{actions:p.exports.createElement(Ta,null),aside:p.exports.createElement(Oa,null),filterDefaultValues:{sales_id:null==t?void 0:t.id},pagination:p.exports.createElement(Ze,{rowsPerPageOptions:[15,25,50,100]}),perPage:25,sort:{field:"name",order:"ASC"},component:"div"}),p.exports.createElement(Pa,null)):null},create:e=>{const t=Fa(),{identity:r}=Pe();return p.exports.createElement(Ot,i(s({},e),{actions:!1}),p.exports.createElement(Dt,{component:La,redirect:"show",initialValues:{sales_id:null==r?void 0:r.id}},p.exports.createElement(ut,{source:"name",validate:vt(),fullWidth:!0}),p.exports.createElement(Tt,{source:"sector",choices:ya,formClassName:Se(t.inline,"first-child")}),p.exports.createElement(Tt,{source:"size",choices:Ia,formClassName:t.inline}),p.exports.createElement(Aa,null),p.exports.createElement(ut,{source:"address",fullWidth:!0,helperText:!1}),p.exports.createElement(ut,{source:"city",formClassName:Se(t.inline,"first-child")}),p.exports.createElement(ut,{source:"zipcode",formClassName:t.inline}),p.exports.createElement(ut,{source:"stateAbbr",formClassName:t.inline}),p.exports.createElement(Aa,null),p.exports.createElement(ut,{source:"website",fullWidth:!0,helperText:!1}),p.exports.createElement(ut,{source:"linkedIn",fullWidth:!0,helperText:!1}),p.exports.createElement(ut,{source:"logo",fullWidth:!0}),p.exports.createElement(Aa,null),p.exports.createElement(ut,{source:"phone_number",formClassName:Se(t.inline,"first-child"),helperText:!1}),p.exports.createElement(xt,{source:"sales_id",reference:"sales",label:"Account manager",formClassName:t.inline,helperText:!1},p.exports.createElement(Tt,{optionText:e=>`${e.first_name} ${e.last_name}`,validate:vt()}))))},edit:e=>{const t=Ka();return p.exports.createElement(Lt,i(s({},e),{aside:p.exports.createElement(ja,{link:"show"}),actions:!1}),p.exports.createElement(Dt,{component:qa,redirect:"show"},p.exports.createElement(ut,{source:"name",validate:vt(),fullWidth:!0}),p.exports.createElement(Tt,{source:"sector",choices:ya,formClassName:Se(t.inline,"first-child")}),p.exports.createElement(Tt,{source:"size",choices:Ia,formClassName:t.inline}),p.exports.createElement(Ha,null),p.exports.createElement(ut,{source:"address",fullWidth:!0,helperText:!1}),p.exports.createElement(ut,{source:"city",formClassName:Se(t.inline,"first-child")}),p.exports.createElement(ut,{source:"zipcode",formClassName:t.inline}),p.exports.createElement(ut,{source:"stateAbbr",formClassName:t.inline}),p.exports.createElement(Ha,null),p.exports.createElement(ut,{source:"website",fullWidth:!0,helperText:!1}),p.exports.createElement(ut,{source:"linkedIn",fullWidth:!0,helperText:!1}),p.exports.createElement(ut,{source:"logo",fullWidth:!0}),p.exports.createElement(Ha,null),p.exports.createElement(ut,{source:"phone_number",formClassName:Se(t.inline,"first-child"),helperText:!1}),p.exports.createElement(xt,{source:"sales_id",reference:"sales",label:"Account manager",formClassName:t.inline,helperText:!1},p.exports.createElement(Tt,{optionText:e=>`${e.first_name} ${e.last_name}`}))))},show:e=>p.exports.createElement(Le,s({},e),p.exports.createElement($a,null))};const Ja=C((e=>({root:{marginBottom:e.spacing(1)},cardContent:{padding:e.spacing(1),display:"flex"},cardText:{marginLeft:e.spacing(1)}}))),Xa=({deal:e,index:t})=>{const r=Ja(),a=x();if(!e)return null;const n=()=>{a(`/deals/${e.id}/show`)};return p.exports.createElement(At,{draggableId:String(e.id),index:t},((t,a)=>p.exports.createElement("div",i(s(s({className:r.root},t.draggableProps),t.dragHandleProps),{ref:t.innerRef,onClick:n}),p.exports.createElement(y,{style:{opacity:a.isDragging?.9:1,transform:a.isDragging?"rotate(-2deg)":""},elevation:a.isDragging?3:1},p.exports.createElement("div",{className:r.cardContent},p.exports.createElement(be,{source:"company_id",record:e,reference:"companies",resource:"deals",basePath:"/deals"},p.exports.createElement(Gr,{size:"small"})),p.exports.createElement("div",{className:r.cardText},p.exports.createElement(R,{variant:"body2",gutterBottom:!0},e.name),p.exports.createElement(R,{variant:"caption",color:"textSecondary"},e.amount.toLocaleString("en-US",{notation:"compact",style:"currency",currency:"USD",currencyDisplay:"narrowSymbol",minimumSignificantDigits:3}),", ",e.type)))))))},Ya=C({root:{flex:1,paddingTop:8,paddingBottom:16,backgroundColor:"#eaeaee","&:first-child":{paddingLeft:5,borderTopLeftRadius:5},"&:last-child":{paddingRight:5,borderTopRightRadius:5}},droppable:{display:"flex",flexDirection:"column",borderRadius:5,padding:5,"&.isDraggingOver":{backgroundColor:"#dadadf"}}}),Za=({stage:e,dealIds:t,data:r})=>{const a=Ya();return p.exports.createElement("div",{className:a.root},p.exports.createElement(R,{align:"center",variant:"subtitle1"},za[e]),p.exports.createElement(jt,{droppableId:e},((e,n)=>p.exports.createElement("div",i(s({ref:e.innerRef},e.droppableProps),{className:a.droppable+(n.isDraggingOver?" isDraggingOver":"")}),t.map(((e,t)=>p.exports.createElement(Xa,{key:e,index:t,deal:r[e]}))),e.placeholder))))},Qa=Wa.reduce(((e,t)=>i(s({},e),{[t]:[]})),{}),en=(e,t)=>{const r=e.reduce(((e,r)=>(e[t[r].stage].push(r),e)),Wa.reduce(((e,t)=>i(s({},e),{[t]:[]})),{}));return Wa.forEach((e=>{r[e]=r[e].sort(((e,r)=>t[e].index-t[r].index))})),r},tn=()=>{const{data:e,ids:t,loaded:r,page:a,perPage:n,currentSort:o,filterValues:l}=ve(),[c,m]=p.exports.useState(r?en(t,e):Qa),d=p.exports.useContext(Wt),[u]=zt({resource:"deals",type:"getList",payload:{pagination:{page:a,perPage:n},sort:o,filter:l}});if(p.exports.useEffect((()=>{if(!r)return;const a=en(t,e);Bt(c,a)||m(a)}),[e,t,r]),!r)return null;return p.exports.createElement($t,{onDragEnd:async t=>{var r;const{destination:a,source:n,draggableId:o}=t;if(a&&(a.droppableId!==n.droppableId||a.index!==n.index))if(n.droppableId===a.droppableId){const t=Array.from(c[n.droppableId]),r=e[t[n.index]],l=e[t[a.index]];t.splice(n.index,1),t.splice(a.index,0,Number(o)),m(i(s({},c),{[n.droppableId]:t}));const{data:p}=await d.getList("deals",{sort:{field:"index",order:"ASC"},pagination:{page:1,perPage:100},filter:{stage:n.droppableId}});n.index>a.index?(await Promise.all([...p.filter((e=>e.index>=l.index&&e.index<r.index)).map((e=>d.update("deals",{id:e.id,data:{index:e.index+1},previousData:e}))),d.update("deals",{id:r.id,data:{index:l.index},previousData:r})]),u()):(await Promise.all([...p.filter((e=>e.index<=l.index&&e.index>r.index)).map((e=>d.update("deals",{id:e.id,data:{index:e.index-1},previousData:e}))),d.update("deals",{id:r.id,data:{index:l.index},previousData:r})]),u())}else{const t=Array.from(c[n.droppableId]),l=Array.from(c[a.droppableId]),p=e[t[n.index]],x=e[l[a.index]];t.splice(n.index,1),l.splice(a.index,0,o),m(i(s({},c),{[n.droppableId]:t,[a.droppableId]:l}));const[{data:f},{data:E}]=await Promise.all([d.getList("deals",{sort:{field:"index",order:"ASC"},pagination:{page:1,perPage:100},filter:{stage:n.droppableId}}),d.getList("deals",{sort:{field:"index",order:"ASC"},pagination:{page:1,perPage:100},filter:{stage:a.droppableId}})]);await Promise.all([...f.filter((e=>e.index>p.index)).map((e=>d.update("deals",{id:e.id,data:{index:e.index-1},previousData:e}))),...E.filter((e=>!!x&&e.index>=x.index)).map((e=>d.update("deals",{id:e.id,data:{index:e.index+1},previousData:e}))),d.update("deals",{id:p.id,data:{index:x?x.index:((null==(r=E.pop())?void 0:r.index)||0)+1,stage:a.droppableId},previousData:p})]),u()}}},p.exports.createElement($,{display:"flex"},Wa.map((t=>p.exports.createElement(Za,{stage:t,dealIds:c[t],data:e,key:t})))))},rn=["React-admin Enterprise","GreenFrame","Innovation"].map((e=>({id:e,name:e}))),an=C({root:{width:500}}),nn=({open:e})=>{const t=an(),r=x(),a=Rt(),{identity:n}=Pe();return p.exports.createElement(ie,{open:e,onClose:()=>{r("/deals")}},p.exports.createElement(Ot,{resource:"deals",basePath:"/deals",className:t.root,onSuccess:({data:e})=>{r("/deals"),a.getList("deals",{pagination:{page:1,perPage:50},sort:{field:"id",order:"ASC"},filter:{stage:e.stage}}).then((({data:t})=>Promise.all(t.filter((t=>t.id!==e.id)).map((e=>a.update("deals",{id:e.id,data:{index:e.index+1},previousData:e}))))))}},p.exports.createElement(Dt,{initialValues:{index:0,sales_id:null==n?void 0:n.id}},p.exports.createElement(ut,{source:"name",label:"Deal name",fullWidth:!0,validate:[vt()]}),p.exports.createElement(ut,{source:"description",multiline:!0,rows:3,fullWidth:!0}),p.exports.createElement(xt,{source:"company_id",reference:"companies",fullWidth:!0,validate:[vt()]},p.exports.createElement(ft,{optionText:"name"})),p.exports.createElement(Tt,{source:"stage",choices:Ba,fullWidth:!0,validate:[vt()],defaultValue:"opportunity"}),p.exports.createElement(Tt,{source:"type",choices:rn,fullWidth:!0}),p.exports.createElement(Mt,{source:"amount",fullWidth:!0,defaultValue:0}))))},on=C({ul:{listStyle:"none",padding:0,margin:0,display:"inline-block"},li:{display:"inline","&:after":{content:'", "'},"&:last-child:after":{content:'""'}}}),ln=()=>{const{ids:e,data:t,loaded:r}=ve(),a=on();return r?p.exports.createElement("ul",{className:a.ul},e.map((e=>p.exports.createElement("li",{key:e,className:a.li},p.exports.createElement(wt,{component:U,to:`/contacts/${e}`,variant:"subtitle1"},t[e].first_name," ",t[e].last_name))))):p.exports.createElement("div",{style:{height:"2em"}})},sn=C({dialog:{position:"absolute",top:50}}),cn=({open:e,id:t})=>{const r=x(),a=sn();return p.exports.createElement(ie,{open:e,onClose:()=>{r("/deals")},fullWidth:!0,maxWidth:"md",classes:{paper:a.dialog}},p.exports.createElement(Le,{resource:"deals",basePath:"/deals",id:t},p.exports.createElement(me,null,p.exports.createElement(mn,null))))},mn=()=>{const e=ke();return e?p.exports.createElement(p.exports.Fragment,null,p.exports.createElement($,{display:"flex"},p.exports.createElement($,{width:100,display:"flex",flexDirection:"column",alignItems:"center"},p.exports.createElement(be,{source:"company_id",reference:"companies",link:"show"},p.exports.createElement(wa,null)),p.exports.createElement(be,{source:"company_id",reference:"companies",link:"show"},p.exports.createElement(Ee,{source:"name",align:"center",component:"div"}))),p.exports.createElement($,{ml:2,flex:"1"},p.exports.createElement(R,{variant:"h5"},e.name),p.exports.createElement($,{display:"flex",mt:2},p.exports.createElement($,{display:"flex",mr:5,flexDirection:"column"},p.exports.createElement(R,{color:"textSecondary",variant:"body2"},"Start"),p.exports.createElement(R,{variant:"subtitle1"},Vt(new Date(e.start_at),"PP"))),p.exports.createElement($,{display:"flex",mr:5,flexDirection:"column"},p.exports.createElement(R,{color:"textSecondary",variant:"body2"},"Budget"),p.exports.createElement(R,{variant:"subtitle1"},e.amount.toLocaleString("en-US",{notation:"compact",style:"currency",currency:"USD",currencyDisplay:"narrowSymbol",minimumSignificantDigits:3}))),p.exports.createElement($,{display:"flex",mr:5,flexDirection:"column"},p.exports.createElement(R,{color:"textSecondary",variant:"body2"},"Type"),p.exports.createElement(R,{variant:"subtitle1"},e.type)),p.exports.createElement($,{display:"flex",mr:5,flexDirection:"column"},p.exports.createElement(R,{color:"textSecondary",variant:"body2"},"Stage"),p.exports.createElement(R,{variant:"subtitle1"},za[e.stage]))),p.exports.createElement($,{mt:2,mb:2},p.exports.createElement($,{display:"flex",mr:5,flexDirection:"column",minHeight:48},p.exports.createElement(R,{color:"textSecondary",variant:"body2"},"Contacts"),p.exports.createElement(We,{source:"contact_ids",reference:"contacts"},p.exports.createElement(ln,null)))),p.exports.createElement($,{mt:2,mb:2,style:{whiteSpace:"pre-line"}},p.exports.createElement(R,{color:"textSecondary",variant:"body2"},"Description"),p.exports.createElement(R,null,e.description)),p.exports.createElement(xe,null),p.exports.createElement($,{mt:2},p.exports.createElement(ye,{target:"deal_id",reference:"dealNotes",sort:{field:"date",order:"DESC"}},p.exports.createElement(la,{reference:"deals"}))))),p.exports.createElement(de,null,p.exports.createElement(Ut,{undoable:!0,record:e}))):null},dn=C((e=>({root:{marginBottom:e.spacing(1),marginLeft:e.spacing(1)}}))),pn=({alwaysOn:e})=>{const{filterValues:t,displayedFilters:r,setFilters:a}=Kt(),{identity:n}=Pe(),o=dn();return p.exports.createElement("div",{className:o.root},p.exports.createElement(qt,{control:p.exports.createElement(Ht,{checked:void 0!==t.sales_id,onChange:()=>{const e=s({},t);void 0!==t.sales_id?delete e.sales_id:e.sales_id=n&&(null==n?void 0:n.id),a(e,r)},color:"primary",name:"checkedC"}),label:"Only companies I manage"}))};pn.defaultProps={source:"sales_id"};const un=e=>p.exports.createElement(Jt,s({},e),p.exports.createElement(Xt,{source:"q",alwaysOn:!0}),p.exports.createElement(pn,{alwaysOn:!0}),p.exports.createElement(Tt,{source:"type",choices:rn})),xn=C((e=>({createButton:{marginLeft:e.spacing(2)}}))),fn=e=>{const t=xn();return p.exports.createElement(lt,null,p.exports.createElement(un,{context:"button"}),p.exports.createElement(it,null),p.exports.createElement(ct,{basePath:"/deals",variant:"contained",label:"New Deal",className:t.createButton}))};var En={list:e=>{const{identity:t}=Pe();return t?p.exports.createElement(p.exports.Fragment,null,p.exports.createElement(Ye,i(s({},e),{perPage:100,sort:{field:"index",order:"ASC"},filters:p.exports.createElement(un,null),filterDefaultValues:{sales_id:t&&(null==t?void 0:t.id)},actions:p.exports.createElement(fn,null),pagination:!1,component:"div"}),p.exports.createElement(tn,null)),p.exports.createElement(Gt,{path:"/deals/create"},(({match:e})=>p.exports.createElement(nn,{open:!!e}))),p.exports.createElement(Gt,{path:"/deals/:id/show"},(({match:e})=>{var t;return e?p.exports.createElement(cn,{open:!!e,id:null==(t=null==e?void 0:e.params)?void 0:t.id}):null}))):null}};const gn={opportunity:.2,"proposal-sent":.5,"in-negociation":.8,delayed:.3},bn=()=>{const{data:e,ids:t,loaded:r}=Q("deals",{perPage:100,page:1},{field:"start_at",order:"ASC"}),[a,n]=p.exports.useState([]);if(p.exports.useEffect((()=>{const r=t.map((t=>e[t])).reduce(((e,t)=>{const r=qe(new Date(t.start_at)).toISOString();return e[r]||(e[r]=[]),e[r].push(t),e}),{}),a=Object.keys(r).map((e=>({date:Vt(new Date(e),"MMM"),won:r[e].filter((e=>"won"===e.stage)).reduce(((e,t)=>e+=t.amount),0),pending:r[e].filter((e=>!["won","lost"].includes(e.stage))).reduce(((e,t)=>e+=t.amount*gn[t.stage]),0),lost:r[e].filter((e=>"lost"===e.stage)).reduce(((e,t)=>e-=t.amount),0)})));n(a)}),[t,e]),!r)return null;const o=a.reduce(((e,t)=>(e.min=Math.min(e.min,t.lost),e.max=Math.max(e.max,t.won+t.pending),e)),{min:0,max:0});return p.exports.createElement(p.exports.Fragment,null,p.exports.createElement($,{display:"flex",alignItems:"center"},p.exports.createElement($,{ml:2,mr:2,display:"flex"},p.exports.createElement(Yt,{color:"disabled",fontSize:"large"})),p.exports.createElement(wt,{underline:"none",variant:"h5",color:"textSecondary",component:U,to:"/deals"},"Upcoming Deal Revenue")),p.exports.createElement($,{height:500},p.exports.createElement(Zt,{data:a,indexBy:"date",keys:["won","pending","lost"],colors:["#61cdbb","#97e3d5","#e25c3b"],margin:{top:50,right:50,bottom:50,left:0},padding:.3,valueScale:{type:"linear",min:1.2*o.min,max:1.2*o.max},indexScale:{type:"band",round:!0},enableGridX:!0,enableGridY:!1,enableLabel:!1,axisTop:{tickSize:0,tickPadding:12},axisBottom:{legendPosition:"middle",legendOffset:50,tickSize:0,tickPadding:12},axisLeft:null,axisRight:{format:e=>`${Math.abs(e/1e3)}k`,tickValues:8},markers:[{axis:"y",value:0,lineStyle:{strokeOpacity:0},textStyle:{fill:"#2ebca6"},legend:"Won",legendPosition:"top-left",legendOrientation:"vertical"},{axis:"y",value:0,lineStyle:{stroke:"#f47560",strokeWidth:1},textStyle:{fill:"#e25c3b"},legend:"Lost",legendPosition:"bottom-left",legendOrientation:"vertical"}]})))},hn=()=>{const{identity:e}=Pe(),{data:t,ids:r,total:a,loaded:n}=Q("contacts",{page:1,perPage:10},{field:"last_seen",order:"DESC"},{status:"hot",sales_id:null==e?void 0:e.id},{enabled:Number.isInteger(null==e?void 0:e.id)});return p.exports.createElement(p.exports.Fragment,null,p.exports.createElement($,{display:"flex",alignItems:"center",marginBottom:"1em"},p.exports.createElement($,{ml:2,mr:2,display:"flex"},p.exports.createElement(Qt,{color:"disabled",fontSize:"large"})),p.exports.createElement(wt,{underline:"none",variant:"h5",color:"textSecondary",component:U,to:"/contacts"},"Hot contacts")),p.exports.createElement(y,null,p.exports.createElement(er,{basePath:"/contacts",linkType:"show",ids:r,data:t,total:a,loaded:n,primaryText:e=>`${e.first_name} ${e.last_name}`,secondaryText:e=>ot(new Date(e.last_seen),new Date,{addSuffix:!0}),leftAvatar:e=>p.exports.createElement($r,{record:e})})))},yn=C((e=>({note:{marginBottom:e.spacing(2)},noteText:{backgroundColor:"#edf3f0",padding:e.spacing(1),borderRadius:10},noteTextText:{display:"-webkit-box","-webkit-line-clamp":3,"-webkit-box-orient":"vertical",overflow:"hidden"}}))),vn=()=>{const e=yn(),{identity:t}=Pe(),{data:r,ids:a,loaded:n}=Q("contactNotes",{page:1,perPage:5},{field:"date",order:"DESC"},{sales_id:null==t?void 0:t.id},{enabled:Number.isInteger(null==t?void 0:t.id)}),{data:o,ids:l,loaded:c}=Q("dealNotes",{page:1,perPage:5},{field:"date",order:"DESC"},{sales_id:null==t?void 0:t.id},{enabled:Number.isInteger(null==t?void 0:t.id)});if(!n||!c)return null;if(!(a&&r&&l&&o))return null;const m=[].concat(a.map((e=>i(s({},r[e]),{type:"contactNote"}))),l.map((e=>i(s({},o[e]),{type:"dealNote"})))).sort(((e,t)=>new Date(t.date).valueOf()-new Date(e.date).valueOf())).slice(0,5);return p.exports.createElement(p.exports.Fragment,null,p.exports.createElement($,{display:"flex",alignItems:"center",marginBottom:"1em"},p.exports.createElement($,{ml:2,mr:2,display:"flex"},p.exports.createElement(tr,{color:"disabled",fontSize:"large"})),p.exports.createElement(R,{variant:"h5",color:"textSecondary"},"My Latest Notes")),p.exports.createElement(y,null,p.exports.createElement(je,null,m.map((t=>p.exports.createElement("div",{id:`${t.type}_${t.id}`,key:`${t.type}_${t.id}`,className:e.note},p.exports.createElement(R,{color:"textSecondary",gutterBottom:!0},"on"," ","dealNote"===t.type?p.exports.createElement(wn,{note:t}):p.exports.createElement(_n,{note:t}),", added"," ",ot(new Date(t.date),new Date,{addSuffix:!0})),p.exports.createElement("div",{className:e.noteText},p.exports.createElement(R,{className:e.noteTextText},t.text))))))))},wn=({note:e})=>p.exports.createElement(p.exports.Fragment,null,"Deal"," ",p.exports.createElement(be,{record:e,source:"deal_id",reference:"deals",basePath:"/deals",link:"show"},p.exports.createElement(Ee,{source:"name",variant:"body1"}))),_n=({note:e})=>p.exports.createElement(p.exports.Fragment,null,"Contact"," ",p.exports.createElement(be,{record:e,source:"contact_id",reference:"contacts",basePath:"/contacts",link:"show"},p.exports.createElement(he,{variant:"body1",render:e=>e?`${e.first_name} ${e.last_name}`:""}))),Sn=()=>{const{identity:e}=Pe(),{data:t,ids:r,total:a,loaded:n}=Q("deals",{page:1,perPage:10},{field:"last_seen",order:"DESC"},{stage_neq:"lost",sales_id:null==e?void 0:e.id},{enabled:Number.isInteger(null==e?void 0:e.id)}),[o,l]=p.exports.useState(r);return p.exports.useEffect((()=>{const e=r.map((e=>t[e])),a=[];Wa.filter((e=>"won"!==e)).forEach((t=>e.filter((e=>e.stage===t)).forEach((e=>a.push(e.id))))),l(a)}),[r,t]),p.exports.createElement(p.exports.Fragment,null,p.exports.createElement($,{display:"flex",alignItems:"center",marginBottom:"1em"},p.exports.createElement($,{ml:2,mr:2,display:"flex"},p.exports.createElement(Nt,{color:"disabled",fontSize:"large"})),p.exports.createElement(wt,{underline:"none",variant:"h5",color:"textSecondary",component:U,to:"/deals"},"Deals Pipeline")),p.exports.createElement(y,null,p.exports.createElement(er,{basePath:"/deals",linkType:"show",ids:o,data:t,total:a,loaded:n,primaryText:e=>e.name,secondaryText:e=>`${e.amount.toLocaleString("en-US",{notation:"compact",style:"currency",currency:"USD",currencyDisplay:"narrowSymbol",minimumSignificantDigits:3})} , ${za[e.stage]}`,leftAvatar:e=>p.exports.createElement(be,{source:"company_id",record:e,reference:"companies",resource:"deals",basePath:"/deals",link:!1},p.exports.createElement(wa,{size:"small"}))})))},kn=()=>p.exports.createElement(p.exports.Fragment,null,p.exports.createElement($,{display:"flex",mt:"2em"},p.exports.createElement(bn,null)),p.exports.createElement($,{display:"flex",mt:"2em"},p.exports.createElement($,{flex:"1",mr:"1em"},p.exports.createElement(vn,null)),p.exports.createElement($,{flex:"1",display:"flex"},p.exports.createElement($,{flex:"1",mr:"1em"},p.exports.createElement(hn,null)),p.exports.createElement($,{flex:"1"},p.exports.createElement(Sn,null))))),Cn=E(S),Nn=rr(),Pn=()=>p.exports.createElement(ar,{dataProvider:Tr,authProvider:Ar,layout:Br,dashboard:kn,theme:Cn,loginPage:Or,customRoutes:Nr,history:Nn},p.exports.createElement(nr,s({name:"deals"},En)),p.exports.createElement(nr,s({name:"contacts"},ha)),p.exports.createElement(nr,s({name:"companies"},Ga)),p.exports.createElement(nr,{name:"contactNotes"}),p.exports.createElement(nr,{name:"dealNotes"}),p.exports.createElement(nr,{name:"tasks",list:or}),p.exports.createElement(nr,{name:"sales",list:or}),p.exports.createElement(nr,{name:"tags",list:or})),In={};var On,Dn,Tn;lr.render(g.createElement(g.StrictMode,null,g.createElement(Pn,null)),document.getElementById("root")),On&&On instanceof Function&&(Dn=()=>import("./web-vitals.a5292a3a.js"),Tn=[],Tn&&0!==Tn.length?Promise.all(Tn.map((e=>{if((e=`/${e}`)in In)return;In[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script",a.crossOrigin=""),a.href=e,document.head.appendChild(a),t?new Promise(((e,t)=>{a.addEventListener("load",e),a.addEventListener("error",t)})):void 0}))).then((()=>Dn())):Dn()).then((({getCLS:e,getFID:t,getFCP:r,getLCP:a,getTTFB:n})=>{e(On),t(On),r(On),a(On),n(On)}));
